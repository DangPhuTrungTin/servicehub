{% import 'macros/form.html' as form %}
<form id="service-edit" class="dataset-form" method="post" data-module="basic-form" enctype="multipart/form-data">
  {% block error_summary %}
    {{ form.errors(error_summary) }}
  {% endblock %}

  {% block basic_fields %}
    {% set attrs = {'data-module': 'slug-preview-target', 'class': 'form-control'} %}
    {{ form.input('app_name', label=_('Name'), id='field-name', placeholder=_('Service A or Stack A'), value=data.title, error=errors.title, classes=['control-full'], attrs=attrs,is_required=True) }}

    {{ form.markdown('description', label=_('Description'), id='field-description', placeholder=_('A little information about my group...'), value=data.description, error=errors.description) }}

  {% endblock %}

  {% block code_fields %}
    {{ form.select('language', label='Choose program language', id='programmingLanguage', options=[{'value':'Python','text':'Python'},{'text':'Java','value':'Java'},{'text':'Javascript','value':'Javascript'}], classes=['control-full'],is_required=True) }}
    {{ form.input('codeFile', label='Upload code here', id='codeFile', type='file', classes=['control-full'],is_required=True) }}
  {% endblock %}




  <label class="control-label" for="parameters"><span title="This field is required" class="control-required">*</span>
    Define parameters</label>
  <div class="params">
    <div class="form-row param">
      <div class="col-md-4 md-mb-10 md-mt-10">
        <label class="control-label" for="parameters"><span title="This field is required"
                                                            class="control-required">*</span>
          Label</label>
      </div>
      <div class="col-md-4 md-mb-10 md-mt-10">
        <label class="control-label" for="parameters"><span title="This field is required"
                                                            class="control-required">*</span>
          Variable name</label>
      </div>
      <div class="col-md-3 md-mb-10 md-mt-10">
        <label class="control-label" for="parameters"><span title="This field is required"
                                                            class="control-required">*</span>
          Type</label>
      </div>
      <div class="col-md-1 md-mb-10 md-mt-10">
        <label class="control-label" for="parameters">Delete</label>
      </div>
    </div>
  </div>
  <a class="btn btn-success" onclick="addParam()">Add parameter</a>

  {{ form.required_message() }}
  <div class="form-actions">
    <button class="btn btn-primary" name="save" type="submit">
      {% block save_text %}{{ _('Save Service') }}{% endblock %}</button>
  </div>
</form>

<script>
  function deleteParam(div) {
    div.remove();
  }

  function addParam() {
    let params_div = $('div.params');
    params_div.append(`
    <div class="form-row param">
      <div class="col-md-4 md-mb-10 md-mt-10">
        <input class="form-control" type="text" name="label">
      </div>
      <div class="col-md-4 md-mb-10 md-mt-10">
        <input class="form-control" type="text" name="var_name">
      </div>
      <div class="col-md-3 md-mb-10 md-mt-10">
        <select name="type" class="form-control">
          <option value="text">Text</option>
          <option value="number">Number</option>
          <option value="file">File</option>
        </select>
      </div>
      <div class="col-md-1 md-mb-10 md-mt-10">
        <a class="btn btn-danger" onclick="deleteParam($(this).parents('div.param'))"><i class="fa fa-trash"></i></a>
      </div>
    </div>
    `);
  }
</script>
